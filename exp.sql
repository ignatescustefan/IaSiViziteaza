--------------------------------------------------------
--  File created - Thursday-November-21-2019   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Sequence ACCES_RIGHT_ID_ACCES_RIGHT_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."ACCES_RIGHT_ID_ACCES_RIGHT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence ATTRACTION_ID_ATTRACTION_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."ATTRACTION_ID_ATTRACTION_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence ATTRACTION_TYPE_ID_ATTRACTION_
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."ATTRACTION_TYPE_ID_ATTRACTION_"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence COMMENT_ID_COMMENT_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."COMMENT_ID_COMMENT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75131 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75131 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75134 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75134 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75137 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75137 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75141 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75141 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75144 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75144 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
-- Unable to render SEQUENCE DDL for object PROIECT.ISEQ$$_75148 with DBMS_METADATA attempting internal generator.
CREATE SEQUENCE ISEQ$$_75148 INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER
--------------------------------------------------------
--  DDL for Sequence LOCATION_ID_LOCATION_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."LOCATION_ID_LOCATION_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence USER_ID_USER_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "PROIECT"."USER_ID_USER_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Table ACCES_RIGHT
--------------------------------------------------------

  CREATE TABLE "PROIECT"."ACCES_RIGHT" 
   (	"ID_ACCES_RIGHT" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"USER_PRIORITY" NUMBER(3,0)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table ATTRACTION
--------------------------------------------------------

  CREATE TABLE "PROIECT"."ATTRACTION" 
   (	"ID_ATTRACTION" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"NAME" VARCHAR2(30 BYTE), 
	"DESCRIPTION" VARCHAR2(60 BYTE), 
	"OPEN_TIME" DATE, 
	"CLOSE_TIME" DATE, 
	"CREATE_ATTRACTION_TIME" DATE, 
	"IMAGE_PATH" VARCHAR2(50 BYTE), 
	"LOCATION_ID_LOCATION" NUMBER(7,0), 
	"ATT_TYPE_ID_ATTRACTION_TYPE" NUMBER(7,0), 
	"USER_ID_USER" NUMBER(7,0), 
	"RATING" NUMBER(3,0) DEFAULT 0, 
	"PHONE_NUMBER" VARCHAR2(15 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table ATTRACTION_TYPE
--------------------------------------------------------

  CREATE TABLE "PROIECT"."ATTRACTION_TYPE" 
   (	"ID_ATTRACTION_TYPE" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"TITLE" VARCHAR2(30 BYTE), 
	"DESCRIPTION" VARCHAR2(60 BYTE), 
	"IMAGE_PATH" VARCHAR2(50 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table COMMENT
--------------------------------------------------------

  CREATE TABLE "PROIECT"."COMMENT" 
   (	"ID_COMMENT" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"COMMENT_CONTENT" VARCHAR2(50 BYTE), 
	"POSTING_DATE" DATE, 
	"USER_ID_USER" NUMBER(7,0), 
	"ATTRACTION_ID_ATTRACTION" NUMBER(7,0), 
	"RATING" NUMBER(3,0) DEFAULT 0
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table LOCATION
--------------------------------------------------------

  CREATE TABLE "PROIECT"."LOCATION" 
   (	"ID_LOCATION" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"ADDRESS" VARCHAR2(40 BYTE), 
	"POSTAL_CODE" VARCHAR2(20 BYTE), 
	"ATTRACTION_ID_ATTRACTION" NUMBER(7,0)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table USER
--------------------------------------------------------

  CREATE TABLE "PROIECT"."USER" 
   (	"ID_USER" NUMBER(7,0) GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"FIRST_NAME" VARCHAR2(40 BYTE), 
	"LAST_NAME" VARCHAR2(30 BYTE), 
	"EMAIL" VARCHAR2(50 BYTE), 
	"PASSWORD" VARCHAR2(30 BYTE), 
	"PHONE_NUMBER" VARCHAR2(15 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table USER_TO_RIGHT
--------------------------------------------------------

  CREATE TABLE "PROIECT"."USER_TO_RIGHT" 
   (	"USER_ID_USER" NUMBER(7,0), 
	"ACCES_RIGHT_ID_ACCES_RIGHT" NUMBER(7,0)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into PROIECT.ACCES_RIGHT
SET DEFINE OFF;
Insert into PROIECT.ACCES_RIGHT (ID_ACCES_RIGHT,USER_PRIORITY) values (1,10);
Insert into PROIECT.ACCES_RIGHT (ID_ACCES_RIGHT,USER_PRIORITY) values (2,20);
Insert into PROIECT.ACCES_RIGHT (ID_ACCES_RIGHT,USER_PRIORITY) values (3,30);
REM INSERTING into PROIECT.ATTRACTION
SET DEFINE OFF;
Insert into PROIECT.ATTRACTION (ID_ATTRACTION,NAME,DESCRIPTION,OPEN_TIME,CLOSE_TIME,CREATE_ATTRACTION_TIME,IMAGE_PATH,LOCATION_ID_LOCATION,ATT_TYPE_ID_ATTRACTION_TYPE,USER_ID_USER,RATING,PHONE_NUMBER) values (14,'o lume  nebuna','sdkjasdaj',to_date('09-NOV-19','DD-MON-RR'),to_date('09-NOV-19','DD-MON-RR'),to_date('09-NOV-19','DD-MON-RR'),'o_lume__nebuna9_11_2019_11_19_45_53.png',30,10,6,0,'9372');
Insert into PROIECT.ATTRACTION (ID_ATTRACTION,NAME,DESCRIPTION,OPEN_TIME,CLOSE_TIME,CREATE_ATTRACTION_TIME,IMAGE_PATH,LOCATION_ID_LOCATION,ATT_TYPE_ID_ATTRACTION_TYPE,USER_ID_USER,RATING,PHONE_NUMBER) values (2,'o fain','adsasd',to_date('03-NOV-19','DD-MON-RR'),to_date('03-NOV-19','DD-MON-RR'),to_date('03-NOV-19','DD-MON-RR'),'botanica8_11_2019_11_11_30_45.png',2,1,2,0,'31231');
Insert into PROIECT.ATTRACTION (ID_ATTRACTION,NAME,DESCRIPTION,OPEN_TIME,CLOSE_TIME,CREATE_ATTRACTION_TIME,IMAGE_PATH,LOCATION_ID_LOCATION,ATT_TYPE_ID_ATTRACTION_TYPE,USER_ID_USER,RATING,PHONE_NUMBER) values (15,'fereasaca','e de doamne fereste',to_date('09-NOV-19','DD-MON-RR'),to_date('09-NOV-19','DD-MON-RR'),to_date('09-NOV-19','DD-MON-RR'),'fereasaca_9_11_2019_11_20_4_57.png',31,13,6,2,'3973127');
Insert into PROIECT.ATTRACTION (ID_ATTRACTION,NAME,DESCRIPTION,OPEN_TIME,CLOSE_TIME,CREATE_ATTRACTION_TIME,IMAGE_PATH,LOCATION_ID_LOCATION,ATT_TYPE_ID_ATTRACTION_TYPE,USER_ID_USER,RATING,PHONE_NUMBER) values (18,'3123','312312',to_date('15-NOV-19','DD-MON-RR'),to_date('15-NOV-19','DD-MON-RR'),to_date('15-NOV-19','DD-MON-RR'),'3123_15_11_2019_11_17_19_15.png',34,11,2,0,'3123123');
REM INSERTING into PROIECT.ATTRACTION_TYPE
SET DEFINE OFF;
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (6,'dasdasdas','1e312312','dasdasdas8_11_2019_11_10_55_26.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (11,'O imagine','a munkey','O_imagine8_11_2019_11_11_40_54.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (14,'test','312312312','test_15_11_2019_11_12_12_5.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (3,'gradina','midasd','gradina7_11_2019_11_18_46_35.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (10,'maeroin','312312','maeroin8_11_2019_11_11_22_47.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (1,'Muzeu','F frumos','gradina7_11_2019_11_18_46_35.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (4,'o atractie','123123','o_atractie7_11_2019_11_19_9_6.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (8,'Dudun','312312','Dudun8_11_2019_11_11_7_6.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (9,'gabi','12312','gabi8_11_2019_11_11_12_18.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (12,'Something','desc about smth','Something8_11_2019_11_11_51_49.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (13,'Proasta Europei','hehe','Proasta_Europei8_11_2019_11_11_58_40.png');
Insert into PROIECT.ATTRACTION_TYPE (ID_ATTRACTION_TYPE,TITLE,DESCRIPTION,IMAGE_PATH) values (5,'fain masa','12312312','fain_masa8_11_2019_11_10_49_2.png');
REM INSERTING into PROIECT."COMMENT"
SET DEFINE OFF;
Insert into PROIECT."COMMENT" (ID_COMMENT,COMMENT_CONTENT,POSTING_DATE,USER_ID_USER,ATTRACTION_ID_ATTRACTION,RATING) values (7,'buna tinere',to_date('15-NOV-19','DD-MON-RR'),9,15,0);
Insert into PROIECT."COMMENT" (ID_COMMENT,COMMENT_CONTENT,POSTING_DATE,USER_ID_USER,ATTRACTION_ID_ATTRACTION,RATING) values (5,'Salut!',to_date('09-NOV-19','DD-MON-RR'),6,15,1);
REM INSERTING into PROIECT.LOCATION
SET DEFINE OFF;
Insert into PROIECT.LOCATION (ID_LOCATION,ADDRESS,POSTAL_CODE,ATTRACTION_ID_ATTRACTION) values (30,'ceva pe acolo','9381',14);
Insert into PROIECT.LOCATION (ID_LOCATION,ADDRESS,POSTAL_CODE,ATTRACTION_ID_ATTRACTION) values (31,'o strada','987231',15);
Insert into PROIECT.LOCATION (ID_LOCATION,ADDRESS,POSTAL_CODE,ATTRACTION_ID_ATTRACTION) values (2,'undeva in lume','32141',2);
Insert into PROIECT.LOCATION (ID_LOCATION,ADDRESS,POSTAL_CODE,ATTRACTION_ID_ATTRACTION) values (34,'43223','98723131',18);
REM INSERTING into PROIECT."USER"
SET DEFINE OFF;
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (3,'test','test','marius@mail.com','988765123','1231412');
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (2,'dudu','marin','dudu@mail.com','1234567','2505');
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (9,'doru','maru','doru@mail.com','parola123456','1209321');
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (7,'Andrei','Giea','andrei@mail.com','parola1234','9318321');
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (8,'vita','mail','vita@mail.com','parola123456','93123');
Insert into PROIECT."USER" (ID_USER,FIRST_NAME,LAST_NAME,EMAIL,PASSWORD,PHONE_NUMBER) values (6,'nume','prenume','nume@mail.com','parola12345','987412');
REM INSERTING into PROIECT.USER_TO_RIGHT
SET DEFINE OFF;
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (2,1);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (2,2);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (3,3);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (6,2);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (7,2);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (8,2);
Insert into PROIECT.USER_TO_RIGHT (USER_ID_USER,ACCES_RIGHT_ID_ACCES_RIGHT) values (9,1);
--------------------------------------------------------
--  DDL for Index ACCES_RIGHT_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."ACCES_RIGHT_PK" ON "PROIECT"."ACCES_RIGHT" ("ID_ACCES_RIGHT") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index ATTRACTION_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."ATTRACTION_PK" ON "PROIECT"."ATTRACTION" ("ID_ATTRACTION") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index ATTRACTION_TYPE_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."ATTRACTION_TYPE_PK" ON "PROIECT"."ATTRACTION_TYPE" ("ID_ATTRACTION_TYPE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index ATTRACTION_TYPE_TITLE_UN
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."ATTRACTION_TYPE_TITLE_UN" ON "PROIECT"."ATTRACTION_TYPE" ("TITLE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index COMMENT_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."COMMENT_PK" ON "PROIECT"."COMMENT" ("ID_COMMENT") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index LOCATION_ATR_UN
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."LOCATION_ATR_UN" ON "PROIECT"."LOCATION" ("ATTRACTION_ID_ATTRACTION") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index LOCATION_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."LOCATION_PK" ON "PROIECT"."LOCATION" ("ID_LOCATION") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index USER_EMAIL_UN
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."USER_EMAIL_UN" ON "PROIECT"."USER" ("EMAIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index USER_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."USER_PK" ON "PROIECT"."USER" ("ID_USER") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index USER_TO_RIGHT_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PROIECT"."USER_TO_RIGHT_PK" ON "PROIECT"."USER_TO_RIGHT" ("USER_ID_USER", "ACCES_RIGHT_ID_ACCES_RIGHT") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Trigger ATTRACTIONTYPE_CASCADE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "PROIECT"."ATTRACTIONTYPE_CASCADE" BEFORE
    DELETE ON attraction_type
    FOR EACH ROW
BEGIN
    DELETE FROM attraction
    WHERE
        att_type_id_attraction_type = :old.id_attraction_type;

END;
/
ALTER TRIGGER "PROIECT"."ATTRACTIONTYPE_CASCADE" ENABLE;
--------------------------------------------------------
--  DDL for Trigger CHECK_INSTERT_LOCATION
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "PROIECT"."CHECK_INSTERT_LOCATION" BEFORE
    INSERT ON location
    FOR EACH ROW
DECLARE
    v_check_postal_code NUMBER;
BEGIN
    SELECT
        COUNT(*)
    INTO v_check_postal_code
    FROM
        location
    WHERE
        postal_code = :new.postal_code;

    IF v_check_postal_code > 0 THEN
        raise_application_error(-20000, 'already exists a location at this postal code: ' || :new.postal_code);
    END IF;

END;
/
ALTER TRIGGER "PROIECT"."CHECK_INSTERT_LOCATION" ENABLE;
--------------------------------------------------------
--  DDL for Trigger DELETE_ATTRACTION_CASCADE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "PROIECT"."DELETE_ATTRACTION_CASCADE" BEFORE
    DELETE ON attraction
    FOR EACH ROW
BEGIN
    DELETE FROM "COMMENT"
    WHERE
        attraction_id_attraction = :old.id_attraction;

    DELETE FROM location
    WHERE
        attraction_id_attraction = :old.id_attraction;

END;
/
ALTER TRIGGER "PROIECT"."DELETE_ATTRACTION_CASCADE" ENABLE;
--------------------------------------------------------
--  DDL for Procedure UPDATE_ATTRACTION_RATING
--------------------------------------------------------
set define off;

  CREATE OR REPLACE NONEDITIONABLE PROCEDURE "PROIECT"."UPDATE_ATTRACTION_RATING" (
    v_attraction_id   IN                NUMBER,
    v_increase        IN                NUMBER
) AS
    v_current_rating NUMBER(3);
BEGIN
    SELECT
        rating
    INTO v_current_rating
    FROM
        attraction
    WHERE
        id_attraction = v_attraction_id;

    SAVEPOINT before_update_data;
    IF v_increase < 1 THEN
        v_current_rating := v_current_rating - 1;
    ELSE
        v_current_rating := v_current_rating + 1;
    END IF;

    UPDATE attraction
    SET
        rating = v_current_rating
    WHERE
        id_attraction = v_attraction_id;

    SELECT
        rating
    INTO v_current_rating
    FROM
        attraction
    WHERE
        id_attraction = v_attraction_id;

    IF v_current_rating < 0 THEN
        ROLLBACK TO before_update_data;
        raise_application_error(-20210, 'rating negative');
    END IF;

END update_attraction_rating;

/
--------------------------------------------------------
--  DDL for Procedure UPDATE_COMMENT_RATING
--------------------------------------------------------
set define off;

  CREATE OR REPLACE NONEDITIONABLE PROCEDURE "PROIECT"."UPDATE_COMMENT_RATING" (
    v_comment_id   IN             NUMBER,
    v_increase     IN             NUMBER
) AS
    v_current_rating NUMBER(3);
BEGIN
    SELECT
        rating
    INTO v_current_rating
    FROM
        "COMMENT"
    WHERE
        id_comment = v_comment_id;

    SAVEPOINT before_update_data;
    IF v_increase < 1 THEN
        v_current_rating := v_current_rating - 1;
    ELSE
        v_current_rating := v_current_rating + 1;
    END IF;

    UPDATE "COMMENT"
    SET
        rating = v_current_rating
    WHERE
        id_comment = v_comment_id;

    SELECT
        rating
    INTO v_current_rating
    FROM
        "COMMENT"
    WHERE
        id_comment = v_comment_id;

    IF v_current_rating < 0 THEN
        ROLLBACK TO before_update_data;
        raise_application_error(-20210, 'rating negative');
    END IF;

END update_comment_rating;

/
--------------------------------------------------------
--  DDL for Package DELETE_PROCEDURE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE "PROIECT"."DELETE_PROCEDURE" AS
    PROCEDURE delete_comment (
        v_comment_id IN NUMBER
    );

    PROCEDURE delete_attraction (
        v_attraction_id IN NUMBER
    );

    PROCEDURE delete_attractiontype (
        v_attractiontype_id IN NUMBER
    );

END delete_procedure;

/
--------------------------------------------------------
--  DDL for Package GET_FUNCTION
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE "PROIECT"."GET_FUNCTION" AS 

    FUNCTION get_attractiontype RETURN SYS_REFCURSOR;

    FUNCTION get_attraction RETURN SYS_REFCURSOR;

    FUNCTION get_attraction_by_attraction_type (
        v_title VARCHAR2
    ) RETURN SYS_REFCURSOR;

    FUNCTION get_attractiontypedata (
        v_title VARCHAR2
    ) RETURN SYS_REFCURSOR;

    FUNCTION get_comments_by_attraction_id (
        v_attraction_id VARCHAR2
    ) RETURN SYS_REFCURSOR;

    FUNCTION get_attraction_by_id (
        v_attraction_id NUMBER
    ) RETURN SYS_REFCURSOR;

    FUNCTION get_users RETURN SYS_REFCURSOR;

END get_function;

/
--------------------------------------------------------
--  DDL for Package INSERT_PROCEDURE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE "PROIECT"."INSERT_PROCEDURE" AS
    PROCEDURE insert_attraction_type (
        v_title         IN              VARCHAR2,
        v_description   IN              VARCHAR2,
        v_image         IN              VARCHAR2
    );

    PROCEDURE insert_user (
        v_first_name     IN               VARCHAR2,
        v_last_name      IN               VARCHAR2,
        v_phone_number   IN               VARCHAR2,
        v_email          IN               VARCHAR2,
        v_password       IN               VARCHAR2
    );

    PROCEDURE insert_acces_right (
        v_value IN NUMBER
    );

    PROCEDURE insert_user_to_right (
        v_user_id_user                 IN                             NUMBER,
        v_acces_right_id_acces_right   IN                             NUMBER
    );

    PROCEDURE insert_location (
        v_address         IN                VARCHAR2,
        v_postal_code     IN                VARCHAR2,
        v_attraction_id   IN                NUMBER,
        v_location_id     OUT               NUMBER
    );

    PROCEDURE insert_comment (
        v_content         IN                VARCHAR2,
        v_user_id         IN                NUMBER,
        v_attraction_id   IN                NUMBER
    );

    PROCEDURE insert_attraction (
        v_name                 IN                     VARCHAR2,
        v_desc                 IN                     VARCHAR2,
        v_open_time            IN                     VARCHAR2,
        v_close_time           IN                     VARCHAR2,
        v_phone_number         IN                     VARCHAR,
        v_image                IN                     VARCHAR2,
        v_attraction_type_id   IN                     NUMBER,
        v_location_id          IN                     NUMBER,
        v_user_id              IN                     NUMBER
    );

END insert_procedure;

/
--------------------------------------------------------
--  DDL for Package USER_METHODS
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE "PROIECT"."USER_METHODS" AS 

  /* TODO enter package declarations (types, exceptions, methods etc) here */
    FUNCTION user_login (
        v_email VARCHAR2,
        v_password VARCHAR2
    ) RETURN SYS_REFCURSOR;

    FUNCTION check_user_priority (
        v_email VARCHAR,
        v_priority NUMBER
    ) RETURN NUMBER;

    PROCEDURE update_user_info (
        v_old_email          IN                   VARCHAR2,
        v_new_phone_number   IN                   VARCHAR2,
        v_new_email          IN                   VARCHAR2,
        v_new_password       IN                   VARCHAR2
    );

    FUNCTION get_user_by_email (
        v_email IN VARCHAR2
    ) RETURN SYS_REFCURSOR;

END user_methods;

/
--------------------------------------------------------
--  DDL for Package Body DELETE_PROCEDURE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE BODY "PROIECT"."DELETE_PROCEDURE" AS

    PROCEDURE delete_comment (
        v_comment_id IN NUMBER
    ) AS
    BEGIN
        DELETE FROM "COMMENT"
        WHERE
            id_comment = v_comment_id;

    END delete_comment;

    PROCEDURE delete_attraction (
        v_attraction_id IN NUMBER
    ) AS
    BEGIN
        DELETE FROM attraction
        WHERE
            id_attraction = v_attraction_id;

    END delete_attraction;

    PROCEDURE delete_attractiontype (
        v_attractiontype_id IN NUMBER
    ) AS
    BEGIN
        DELETE FROM attraction_type
        WHERE
            id_attraction_type = v_attractiontype_id;

    END delete_attractiontype;

END delete_procedure;

/
--------------------------------------------------------
--  DDL for Package Body GET_FUNCTION
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE BODY "PROIECT"."GET_FUNCTION" AS

    FUNCTION get_attractiontype RETURN SYS_REFCURSOR AS
        l_rc SYS_REFCURSOR;
    BEGIN
        OPEN l_rc FOR SELECT
                          id_attraction_type,
                          title,
                          description,
                          image_path
                      FROM
                          attraction_type;

        RETURN l_rc;
    END get_attractiontype;

    FUNCTION get_attraction RETURN SYS_REFCURSOR AS
        l_rc SYS_REFCURSOR;
    BEGIN
        OPEN l_rc FOR SELECT
                          a.id_attraction,
                          a.name,
                          a.description,
                          a.open_time,
                          a.close_time,
                          a.create_attraction_time,
                          a.image_path,
                          a.location_id_location,
                          a.att_type_id_attraction_type,
                          a.user_id_user,
                          a.rating,
                          a.phone_number,
                          at.title,
                          u.first_name,
                          u.last_name,
                          l.address,
                          l.postal_code
                      FROM
                          attraction        a,
                          "USER"            u,
                          attraction_type   at,
                          "LOCATION"        l
                      WHERE
                          a.user_id_user = u.id_user
                          AND a.att_type_id_attraction_type = at.id_attraction_type
                          AND l.id_location = a.location_id_location;

        RETURN l_rc;
    END get_attraction;

    FUNCTION get_attraction_by_attraction_type (
        v_title VARCHAR2
    ) RETURN SYS_REFCURSOR AS
        l_rc SYS_REFCURSOR;
    BEGIN
    -- select location
        OPEN l_rc FOR SELECT
                          a.id_attraction,
                          a.name,
                          a.description,
                          a.open_time,
                          a.close_time,
                          a.create_attraction_time,
                          a.image_path,
                          a.location_id_location,
                          a.att_type_id_attraction_type,
                          a.user_id_user,
                          a.rating,
                          a.phone_number,
                          at.title,
                          u.first_name,
                          u.last_name,
                          l.address,
                          l.postal_code
                      FROM
                          attraction        a,
                          "USER"            u,
                          attraction_type   at,
                          "LOCATION"        l
                      WHERE
                          a.user_id_user = u.id_user
                          AND a.att_type_id_attraction_type = at.id_attraction_type
                          AND l.id_location = a.location_id_location
                          AND at.title = v_title;

        RETURN l_rc;
    END get_attraction_by_attraction_type;

    FUNCTION get_attractiontypedata (
        v_title VARCHAR2
    ) RETURN SYS_REFCURSOR AS
        v_attraction_type SYS_REFCURSOR;
    BEGIN
        OPEN v_attraction_type FOR SELECT
                                       *
                                   FROM
                                       attraction_type
                                   WHERE
                                       title = v_title;

        RETURN v_attraction_type;
    END get_attractiontypedata;

    FUNCTION get_comments_by_attraction_id (
        v_attraction_id VARCHAR2
    ) RETURN SYS_REFCURSOR AS
        v_comments SYS_REFCURSOR;
    BEGIN
        OPEN v_comments FOR SELECT
                                c.*,
                                u.first_name,
                                u.last_name
                            FROM
                                "COMMENT"   c,
                                "USER"      u
                            WHERE
                                c.attraction_id_attraction = v_attraction_id
                                AND c.user_id_user = u.id_user;

        RETURN v_comments;
    END get_comments_by_attraction_id;

    FUNCTION get_users RETURN SYS_REFCURSOR AS
        v_users SYS_REFCURSOR;
    BEGIN
        OPEN v_users FOR SELECT
                             id_user,
                             email,
                             first_name,
                             last_name,
                             phone_number,
                             password
                         FROM
                             "USER";

        RETURN v_users;
    END get_users;

    FUNCTION get_attraction_by_id (
        v_attraction_id NUMBER
    ) RETURN SYS_REFCURSOR AS
        v_attraction SYS_REFCURSOR;
    BEGIN
        OPEN v_attraction FOR SELECT
                                  a.id_attraction,
                                  a.name,
                                  a.description,
                                  a.open_time,
                                  a.close_time,
                                  a.create_attraction_time,
                                  a.image_path,
                                  a.location_id_location,
                                  a.att_type_id_attraction_type,
                                  a.user_id_user,
                                  a.rating,
                                  a.phone_number,
                                  at.title,
                                  u.first_name,
                                  u.last_name,
                                  l.address,
                                  l.postal_code
                              FROM
                                  attraction        a,
                                  "USER"            u,
                                  attraction_type   at,
                                  "LOCATION"        l
                              WHERE
                                  a.user_id_user = u.id_user
                                  AND a.att_type_id_attraction_type = at.id_attraction_type
                                  AND l.id_location = a.location_id_location
                                  AND a.id_attraction = v_attraction_id;

        RETURN v_attraction;
    END get_attraction_by_id;

END get_function;

/
--------------------------------------------------------
--  DDL for Package Body INSERT_PROCEDURE
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE BODY "PROIECT"."INSERT_PROCEDURE" AS

    PROCEDURE insert_attraction_type (
        v_title         IN              VARCHAR2,
        v_description   IN              VARCHAR2,
        v_image         IN              VARCHAR2
    ) AS
    BEGIN
        INSERT INTO attraction_type (
            title,
            description,
            image_path
        ) VALUES (
            v_title,
            v_description,
            v_image
        );

    END insert_attraction_type;

    PROCEDURE insert_user (
        v_first_name     IN               VARCHAR2,
        v_last_name      IN               VARCHAR2,
        v_phone_number   IN               VARCHAR2,
        v_email          IN               VARCHAR2,
        v_password       IN               VARCHAR2
    ) AS
    BEGIN
    -- TODO: Implementation required for PROCEDURE INSERT_PROCEDURE.insert_user
        INSERT INTO "PROIECT"."USER" (
            first_name,
            last_name,
            phone_number,
            email,
            password
        ) VALUES (
            v_first_name,
            v_last_name,
            v_phone_number,
            v_email,
            v_password
        );

    END insert_user;

    PROCEDURE insert_acces_right (
        v_value IN NUMBER
    ) AS
    BEGIN
        INSERT INTO acces_right ( user_priority ) VALUES ( v_value );

    END insert_acces_right;

    PROCEDURE insert_location (
        v_address         IN                VARCHAR2,
        v_postal_code     IN                VARCHAR2,
        v_attraction_id   IN                NUMBER,
        v_location_id     OUT               NUMBER
    ) AS
    BEGIN
        IF v_attraction_id IS NULL THEN
            INSERT INTO location (
                address,
                postal_code
            ) VALUES (
                v_address,
                v_postal_code
            );

        ELSE
            INSERT INTO location (
                address,
                postal_code,
                attraction_id_attraction
            ) VALUES (
                v_address,
                v_postal_code,
                v_attraction_id
            );

        END IF;

        SELECT
            id_location
        INTO v_location_id
        FROM
            location
        WHERE
            postal_code = v_postal_code;

    END insert_location;

    PROCEDURE insert_attraction (
       v_name                 IN                     VARCHAR2,
        v_desc                 IN                     VARCHAR2,
        v_open_time            IN                     VARCHAR2,
        v_close_time           IN                     VARCHAR2,
        v_phone_number         IN                     VARCHAR,
        v_image                IN                     VARCHAR2,
        v_attraction_type_id   IN                     NUMBER,
        v_location_id          IN                     NUMBER,
        v_user_id              IN                     NUMBER
    ) AS
        v_attraction_id attraction.id_attraction%TYPE;
    BEGIN
        INSERT INTO attraction (
            name,
            description,
            open_time,
            close_time,
            phone_number,
            create_attraction_time,
            image_path,
            location_id_location,
            att_type_id_attraction_type,
            user_id_user
        ) VALUES (
            v_name,
            v_desc,
            TO_DATE(v_open_time, 'MM/DD/YYYY HH:MI:SS AM'),
            TO_DATE(v_close_time, 'MM/DD/YYYY HH:MI:SS AM'),
            v_phone_number,
            SYSDATE,
            v_image,
            v_location_id,
            v_attraction_type_id,
            v_user_id
        );

        SELECT
            id_attraction
        INTO v_attraction_id
        FROM
            attraction
        WHERE
            location_id_location = v_location_id;

        UPDATE location
        SET
            attraction_id_attraction = v_attraction_id
        WHERE
            id_location = v_location_id;

    END insert_attraction;

    PROCEDURE insert_comment (
        v_content         IN                VARCHAR2,
        v_user_id         IN                NUMBER,
        v_attraction_id   IN                NUMBER
    ) AS
    BEGIN
        INSERT INTO "PROIECT"."COMMENT" (
            comment_content,
            posting_date,
            user_id_user,
            attraction_id_attraction
        ) VALUES (
            v_content,
            SYSDATE,
            v_user_id,
            v_attraction_id
        );

    END insert_comment;

    PROCEDURE insert_user_to_right (
        v_user_id_user                 IN                             NUMBER,
        v_acces_right_id_acces_right   IN                             NUMBER
    ) AS
    BEGIN
        INSERT INTO user_to_right (
            user_id_user,
            acces_right_id_acces_right
        ) VALUES (
            v_user_id_user,
            v_acces_right_id_acces_right
        );

    END insert_user_to_right;

END insert_procedure;

/
--------------------------------------------------------
--  DDL for Package Body USER_METHODS
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE PACKAGE BODY "PROIECT"."USER_METHODS" AS

    FUNCTION user_login (
        v_email VARCHAR2,
        v_password VARCHAR2
    ) RETURN SYS_REFCURSOR AS
        v_user SYS_REFCURSOR;
    BEGIN
        OPEN v_user FOR SELECT
                            *
                        FROM
                            "PROIECT"."USER"
                        WHERE
                            email = v_email
                            AND password = v_password;

        RETURN v_user;
    END user_login;

    FUNCTION check_user_priority (
        v_email VARCHAR,
        v_priority NUMBER
    ) RETURN NUMBER AS
        v_status NUMBER;
    BEGIN
    --
        SELECT
            COUNT(*)
        INTO v_status
        FROM
            "USER"          u,
            acces_right     a,
            user_to_right   ur
        WHERE
            u.email = v_email
            AND a.user_priority = v_priority
            AND u.id_user = ur.user_id_user
            AND ur.acces_right_id_acces_right = a.id_acces_right;

        RETURN v_status;
    END check_user_priority;

    PROCEDURE update_user_info (
        v_old_email          IN                   VARCHAR2,
        v_new_phone_number   IN                   VARCHAR2,
        v_new_email          IN                   VARCHAR2,
        v_new_password       IN                   VARCHAR2
    ) AS
        v_check_new_email VARCHAR2(32);
    BEGIN
    --update "USER" set v
        SELECT
            COUNT(*)
        INTO v_check_new_email
        FROM
            "USER"
        WHERE
            email = v_new_email;

        IF v_check_new_email > 0 THEN
            raise_application_error(-20100, 'already exists a user with this email');
        ELSE
            UPDATE "USER"
            SET
                email = v_new_email,
                password = v_new_password,
                phone_number = v_new_phone_number
            WHERE
                email = v_old_email;

        END IF;

    END update_user_info;

    FUNCTION get_user_by_email (
        v_email IN VARCHAR2
    ) RETURN SYS_REFCURSOR AS
        v_user SYS_REFCURSOR;
    BEGIN
        OPEN v_user FOR SELECT
                            *
                        FROM
                            "USER"
                        WHERE
                            email = v_email;

        RETURN v_user;
    END get_user_by_email;

END user_methods;

/
--------------------------------------------------------
--  Constraints for Table ACCES_RIGHT
--------------------------------------------------------

  ALTER TABLE "PROIECT"."ACCES_RIGHT" MODIFY ("ID_ACCES_RIGHT" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ACCES_RIGHT" MODIFY ("USER_PRIORITY" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ACCES_RIGHT" ADD CONSTRAINT "ACCES_RIGHT_PK" PRIMARY KEY ("ID_ACCES_RIGHT")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table ATTRACTION
--------------------------------------------------------

  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("ID_ATTRACTION" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("NAME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("OPEN_TIME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("CLOSE_TIME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("CREATE_ATTRACTION_TIME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("IMAGE_PATH" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("LOCATION_ID_LOCATION" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("ATT_TYPE_ID_ATTRACTION_TYPE" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" MODIFY ("USER_ID_USER" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION" ADD CONSTRAINT "ATTRACTION_PK" PRIMARY KEY ("ID_ATTRACTION")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table ATTRACTION_TYPE
--------------------------------------------------------

  ALTER TABLE "PROIECT"."ATTRACTION_TYPE" MODIFY ("ID_ATTRACTION_TYPE" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION_TYPE" MODIFY ("TITLE" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION_TYPE" MODIFY ("IMAGE_PATH" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."ATTRACTION_TYPE" ADD CONSTRAINT "ATTRACTION_TYPE_PK" PRIMARY KEY ("ID_ATTRACTION_TYPE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "PROIECT"."ATTRACTION_TYPE" ADD CONSTRAINT "ATTRACTION_TYPE_TITLE_UN" UNIQUE ("TITLE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table COMMENT
--------------------------------------------------------

  ALTER TABLE "PROIECT"."COMMENT" MODIFY ("ID_COMMENT" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."COMMENT" MODIFY ("COMMENT_CONTENT" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."COMMENT" MODIFY ("POSTING_DATE" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."COMMENT" MODIFY ("USER_ID_USER" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."COMMENT" MODIFY ("ATTRACTION_ID_ATTRACTION" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."COMMENT" ADD CONSTRAINT "COMMENT_PK" PRIMARY KEY ("ID_COMMENT")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table LOCATION
--------------------------------------------------------

  ALTER TABLE "PROIECT"."LOCATION" MODIFY ("ID_LOCATION" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."LOCATION" MODIFY ("ADDRESS" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."LOCATION" MODIFY ("POSTAL_CODE" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."LOCATION" ADD CONSTRAINT "LOCATION_PK" PRIMARY KEY ("ID_LOCATION")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "PROIECT"."LOCATION" ADD CONSTRAINT "LOCATION_ATR_UN" UNIQUE ("ATTRACTION_ID_ATTRACTION")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table USER
--------------------------------------------------------

  ALTER TABLE "PROIECT"."USER" MODIFY ("ID_USER" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER" MODIFY ("FIRST_NAME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER" MODIFY ("LAST_NAME" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER" MODIFY ("EMAIL" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER" MODIFY ("PASSWORD" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER" ADD CONSTRAINT "USER_CK_EMAIL" CHECK ( REGEXP_LIKE ( email,
                                                       '[a-z0-9._%-]+@[a-z0-9._%-]+\.[a-z]{2,4}' ) ) ENABLE;
  ALTER TABLE "PROIECT"."USER" ADD CONSTRAINT "USER_CK_PASSWORD" CHECK ( length(password) >= 6 ) ENABLE;
  ALTER TABLE "PROIECT"."USER" ADD CONSTRAINT "USER_PK" PRIMARY KEY ("ID_USER")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "PROIECT"."USER" ADD CONSTRAINT "USER_EMAIL_UN" UNIQUE ("EMAIL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table USER_TO_RIGHT
--------------------------------------------------------

  ALTER TABLE "PROIECT"."USER_TO_RIGHT" MODIFY ("USER_ID_USER" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER_TO_RIGHT" MODIFY ("ACCES_RIGHT_ID_ACCES_RIGHT" NOT NULL ENABLE);
  ALTER TABLE "PROIECT"."USER_TO_RIGHT" ADD CONSTRAINT "USER_TO_RIGHT_PK" PRIMARY KEY ("USER_ID_USER", "ACCES_RIGHT_ID_ACCES_RIGHT")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table ATTRACTION
--------------------------------------------------------

  ALTER TABLE "PROIECT"."ATTRACTION" ADD CONSTRAINT "ATTRACTION_ATTRACTION_TYPE_FK" FOREIGN KEY ("ATT_TYPE_ID_ATTRACTION_TYPE")
	  REFERENCES "PROIECT"."ATTRACTION_TYPE" ("ID_ATTRACTION_TYPE") ENABLE;
  ALTER TABLE "PROIECT"."ATTRACTION" ADD CONSTRAINT "ATTRACTION_LOCATION_FK" FOREIGN KEY ("LOCATION_ID_LOCATION")
	  REFERENCES "PROIECT"."LOCATION" ("ID_LOCATION") ENABLE;
  ALTER TABLE "PROIECT"."ATTRACTION" ADD CONSTRAINT "ATTRACTION_USER_FK" FOREIGN KEY ("USER_ID_USER")
	  REFERENCES "PROIECT"."USER" ("ID_USER") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table COMMENT
--------------------------------------------------------

  ALTER TABLE "PROIECT"."COMMENT" ADD CONSTRAINT "COMMENT_ATTRACTION_FK" FOREIGN KEY ("ATTRACTION_ID_ATTRACTION")
	  REFERENCES "PROIECT"."ATTRACTION" ("ID_ATTRACTION") ENABLE;
  ALTER TABLE "PROIECT"."COMMENT" ADD CONSTRAINT "COMMENT_USER_FK" FOREIGN KEY ("USER_ID_USER")
	  REFERENCES "PROIECT"."USER" ("ID_USER") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table LOCATION
--------------------------------------------------------

  ALTER TABLE "PROIECT"."LOCATION" ADD CONSTRAINT "LOCATION_ATTRACTION_FK" FOREIGN KEY ("ATTRACTION_ID_ATTRACTION")
	  REFERENCES "PROIECT"."ATTRACTION" ("ID_ATTRACTION") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table USER_TO_RIGHT
--------------------------------------------------------

  ALTER TABLE "PROIECT"."USER_TO_RIGHT" ADD CONSTRAINT "USER_TO_RIGHT_ACCES_RIGHT_FK" FOREIGN KEY ("ACCES_RIGHT_ID_ACCES_RIGHT")
	  REFERENCES "PROIECT"."ACCES_RIGHT" ("ID_ACCES_RIGHT") ENABLE;
  ALTER TABLE "PROIECT"."USER_TO_RIGHT" ADD CONSTRAINT "USER_TO_RIGHT_USER_FK" FOREIGN KEY ("USER_ID_USER")
	  REFERENCES "PROIECT"."USER" ("ID_USER") ENABLE;
